<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Suggest.js</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1/css/all.css" rel="stylesheet"/>
  <link href="../css/isp-suggest.css" rel="stylesheet"/>
  <link href="assets/style.css" rel="stylesheet"/>
</head>
<body>
<nav class="navbar navbar-expand text-bg-primary position-sticky top-0 z-1">
  <div class="container-fluid">
    <a class="navbar-brand" href="/CDN/">ISP CDN</a>
    <ul class="navbar-nav ms-auto">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Contents</a>
        <div class="dropdown-menu dropdown-menu-end">
          <a href="#card-1" class="dropdown-item">Server returns a list of strings</a>
          <a href="#card-2" class="dropdown-item">Server returns a list of user objects</a>
          <a href="#card-3" class="dropdown-item">Mark what matches in list</a>
          <a href="#card-4" class="dropdown-item">Fill other inputs with values when item is selected</a>
        </div>
      </li>
      <li class="nav-item">
        <button type="button" class="nav-link" data-bs-toggle="collapse" data-bs-target="#tests">Toggle Tests</button>
      </li>
    </ul>
  </div>
</nav>

<div class="container p-3">
  <h1>Suggest.js</h1>

  <div id="tests" class="collapse" data-toggle="tests">
    <div class="card mb-3">
      <h5 class="card-header text-bg-primary">Test Results</h5>
      <div class="card-body">
        <div class="row g-2">
          <div class="col-6">
            <div>test: <span id="result1" class="text-warning">Running</span></div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-12">
      <div class="card">
        <div class="card-header text-bg-primary d-flex align-items-center">
          <h5 class="flex-fill mb-0">HTML<sup><a href="javascript:void(0);" class="link-light small" data-bs-toggle="tooltip" title="Note: Unlike the other modules, this module has a required function that you must provide. It also didn't make sense to have an initAll function. All uses of this module only target one input per page. Therefor, all HTML inputs on this page would look the same. Below is the HTML for the input in all examples except where otherwise noted."><i class="fa-solid fa-circle-exclamation"></i></a></sup></h5>
          <a href="#" data-clipboard="#template0" title="copy" class="link-light"><i class="fa-solid fa-copy"></i></a>
        </div>
        <div class="card-body">
          <pre><code data-code-target="#template0" data-code-type="xml"></code></pre>
          <template id="template0">
            <input id="suggest" type="text" class="form-control">
          </template>
        </div>
      </div>
    </div>

    <div class="col-12">
      <div id="card-1" class="anchor-offset"></div>
      <div class="card">
        <h5 class="card-header text-bg-primary">Server returns a list of strings</h5>
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <input id="example1" type="text" class="form-control">
            </div>
          </div>
        </div>
        <script type="module">
          import { Suggest, search } from "../js/Suggest.js";

          const orgSearchFn = search.ajax(() => 'https://jsonplaceholder.typicode.com/users');
          const mockSearchFn = async query => (await orgSearchFn()).filter(u => u.name.includes(query)).map(u => u.name);

          // Testing double initialization
          new Suggest('#example1', { searchFn: mockSearchFn });
          new Suggest('#example1', { searchFn: mockSearchFn });
        </script>

        <div class="card-header border-top d-flex">
          <span class="flex-fill">JavaScript</span>
          <a href="#" data-clipboard="#template1" title="copy"><i class="fa-solid fa-copy"></i></a>
        </div>
        <div class="card-body">
          <pre><code data-code-target="#template1" data-code-type="javascript"></code></pre>
          <template id="template1">
            import { Suggest, search } from "https://cdn.jsdelivr.net/gh/IdahoStatePolice/CDN@0.0/js/Suggest.js";

            new Suggest('#suggest', {
              searchFn: search.ajax(query => '/context/ajax/user/nameContains?query=' + query)
            });
          </template>
        </div>
      </div>
    </div>

    <div class="col-12">
      <div id="card-2" class="anchor-offset"></div>
      <div class="card">
        <h5 class="card-header text-bg-primary">Server returns a list of user objects</h5>
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <input id="example2" type="text" class="form-control">
            </div>
          </div>
        </div>
        <script type="module">
          import { Suggest, search } from "../js/Suggest.js";

          const orgSearchFn = search.ajax(() => 'https://jsonplaceholder.typicode.com/users');
          const mockSearchFn = async query => (await orgSearchFn()).filter(u => u.name.includes(query));

          // Testing double initialization
          new Suggest('#example2', {
            searchFn: mockSearchFn,
            labelFn: item => item.name
          });
        </script>

        <div class="card-header border-top d-flex">
          <span class="flex-fill">JavaScript</span>
          <a href="#" data-clipboard="#template2" title="copy"><i class="fa-solid fa-copy"></i></a>
        </div>
        <div class="card-body">
          <pre><code data-code-target="#template2" data-code-type="javascript"></code></pre>
          <template id="template2">
            import { Suggest, search } from "https://cdn.jsdelivr.net/gh/IdahoStatePolice/CDN@0.0/js/Suggest.js";

            new Suggest('#suggest', {
              searchFn: search.ajax(query => '/context/ajax/user/nameContains?query=' + query),
              labelFn: item => item.name
            });
          </template>
        </div>
      </div>
    </div>

    <div class="col-12">
      <div id="card-3" class="anchor-offset"></div>
      <div class="card">
        <h5 class="card-header text-bg-primary">Mark what matches in list</h5>
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <input id="example3" type="text" class="form-control">
            </div>
          </div>
        </div>
        <script type="module">
          import { Suggest, search, mark } from "../js/Suggest.js";

          const orgSearchFn = search.ajax(() => 'https://jsonplaceholder.typicode.com/users');
          const mockSearchFn = async query => (await orgSearchFn()).filter(u => u.name.includes(query));

          // Testing double initialization
          new Suggest('#example3', {
            searchFn: mockSearchFn,
            labelFn: item => item.name,
            markFn: mark.contains
          });
        </script>

        <div class="card-header border-top d-flex">
          <span class="flex-fill">JavaScript</span>
          <a href="#" data-clipboard="#template3" title="copy"><i class="fa-solid fa-copy"></i></a>
        </div>
        <div class="card-body">
          <pre><code data-code-target="#template3" data-code-type="javascript"></code></pre>
          <template id="template3">
            import { Suggest, search, mark } from "https://cdn.jsdelivr.net/gh/IdahoStatePolice/CDN@0.0/js/Suggest.js";

            new Suggest('#suggest', {
              searchFn: search.ajax(query => '/context/ajax/user/nameContains?query=' + query),
              labelFn: item => item.name,
              markFn: mark.contains
            });
          </template>
        </div>
      </div>
    </div>

    <div class="col-12">
      <div id="card-4" class="anchor-offset"></div>
      <div class="card">
        <h5 class="card-header text-bg-primary">Fill other inputs with values when item is selected</h5>
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <input id="example4" type="text" class="form-control">
            </div>
            <div class="col-4">
              <input id="userId4" type="text" class="form-control">
            </div>
          </div>
        </div>
        <script type="module">
          import { Suggest, search, mark } from "../js/Suggest.js";

          const orgSearchFn = search.ajax(() => 'https://jsonplaceholder.typicode.com/users');
          const mockSearchFn = async query => (await orgSearchFn()).filter(u => u.name.includes(query));
          const userIdEl = document.querySelector('#userId4');

          // Testing double initialization
          new Suggest('#example4', {
            searchFn: mockSearchFn,
            labelFn: item => item.name,
            markFn: mark.contains,
            selectFn: item => userIdEl.value = item.id,
            clearFn: () => userIdEl.value = ''
          });
        </script>

        <div class="card-header border-top d-flex">
          <span class="flex-fill">HTML</span>
          <a href="#" data-clipboard="#template4-1" title="copy"><i class="fa-solid fa-copy"></i></a>
        </div>
        <div class="card-body">
          <pre><code data-code-target="#template4-1" data-code-type="xml"></code></pre>
          <template id="template4-1">
            <div class="row">
              <div class="col-4">
                <input id="suggest-4" type="text" class="form-control">
              </div>
              <div class="col-4">
                <input id="userId-4" type="text" class="form-control">
              </div>
            </div>
          </template>
        </div>

        <div class="card-header border-top d-flex">
          <span class="flex-fill">JavaScript</span>
          <a href="#" data-clipboard="#template4-2" title="copy"><i class="fa-solid fa-copy"></i></a>
        </div>
        <div class="card-body">
          <pre><code data-code-target="#template4-2" data-code-type="javascript"></code></pre>
          <template id="template4-2">
            import { Suggest, search, mark } from "https://cdn.jsdelivr.net/gh/IdahoStatePolice/CDN@0.0/js/Suggest.js";

            const userIdEl = document.querySelector('#userId-4');

            new Suggest('#suggest-4', {
              searchFn: search.ajax(query => '/context/ajax/user/nameContains?query=' + query),
              labelFn: item => item.name,
              markFn: mark.contains,
              selectFn: item => userIdEl.value = item.id,
              clearFn: () => userIdEl.value = ''
            });
          </template>
        </div>
      </div>
    </div>

  </div>
</div>

<script type="module" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3/+esm"></script>
<script type="module">
  // import { Suggest } from "../js/Suggest.js";
  import { initExamples, initTestRunner } from "./assets/modules.js";
  // import { tests } from "../tests/row-click-tests.js";
  import { Tooltip } from "https://cdn.jsdelivr.net/npm/bootstrap@5.3/+esm";

  (function main() {
    initExamples();
    // initTestRunner(tests);

    const els = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    [...els].forEach(el => new Tooltip(el));
  })();
</script>
</body>
</html>